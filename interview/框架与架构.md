# 框架与架构

## 虚拟dom是什么? 原理是什么? 有哪些优缺点?

虚拟DOM是一种将DOM表示为JSON方式，它是使用JSON来描述页面上的元素和属性。

原理如下：

- 在内存中构建虚拟 DOM 树。
- 将虚拟 DOM 树渲染为真实的 DOM 树，并且将其添加到页面上。
- 当更新发生时，重新构建虚拟 DOM 树，并使用算法比较前后的差异。
- 将差异更新到真实的 DOM 树上。

虚拟 DOM 的优点：提高渲染效率（减少重排重绘），提升开发效率（通过一些V-DOM框架更易开发），跨平台能力（虚拟 DOM 可以在不同的平台上运行）

虚拟 DOM 的缺点：学习成本高（虚拟DOM的概念比较抽象不容易理解），性能问题（内存开销和树状结构描述，对内存和性能有所影响）

## 小程序框架技术

### taro原理 与 运行时Kbone原理

taro2其实是通过将类似react的写法通过babel编译转换成小程序格式的代码，运行时通过注册Lifecycle,Event,Render去运行兼容各个自定义组件的dom变化和事件行为。（缺点是：写法一致，方法不一定一致，react更新写法同时样更新）
tar3原理：是基于Kbone同构解决方案库来实现了一套taro-runtime方案，在小程序的appService层对web应用中的 dom/bom api的方法调用适配和构造V-DOM节点，运行时通过setData将V-DOM数据传递到小程序的appView层，再通过递归构造小程序DOM实现渲染。（运行时同构方案 -> 模拟DOM/BOM API调用 -> 构造DOM节点 -> 生成V-DOM -> setData -> 递归V-DOM渲染）
